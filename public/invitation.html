<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="version" content="v2.1.0">
    <title>ì˜¤ì‚°ê³ ë“±í•™êµ 71íšŒ ë™ê¸° ì†¡ë…„íšŒ ì´ˆëŒ€ì¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-900 via-blue-700 to-slate-900">
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-80 backdrop-blur-md border-b border-slate-600 shadow-lg">
        <div class="max-w-7xl mx-auto px-2 sm:px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2 sm:space-x-4">
                    <img src="images/osan_log3.svg" alt="ì˜¤ì‚°ê³  ë¡œê³ " class="w-8 h-8 sm:w-12 sm:h-12 object-contain">
                    <h1 class="text-white font-bold text-sm sm:text-lg drop-shadow-sm">ì˜¤ì‚°ê³  71íšŒ ì†¡ë…„íšŒ</h1>
                </div>
                <div class="flex space-x-1 sm:space-x-2">
                    <a href="invitation.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-blue-600 text-white shadow-sm">
                        ğŸŠ <span class="hidden sm:inline">ì´ˆëŒ€ì¥</span>
                    </a>
                    <a href="checkin.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold text-slate-200 hover:text-white hover:bg-slate-700 transition-colors">
                        ğŸ“ <span class="hidden sm:inline">ì²´í¬ì¸</span>
                    </a>
                    <a href="admin.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold text-slate-200 hover:text-white hover:bg-slate-700 transition-colors">
                        âš™ï¸ <span class="hidden sm:inline">ê´€ë¦¬</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="pt-16 min-h-screen flex items-center justify-center px-2 py-2 sm:px-4">
        <main class="w-full max-w-lg bg-gradient-to-br from-blue-800 via-purple-900 to-blue-700 bg-opacity-95 rounded-2xl shadow-2xl border border-blue-700 px-4 py-6 sm:px-8 sm:py-10">
            <!-- í—¤ë” -->
            <div class="flex items-center justify-between mb-4">
                <div class="px-2 py-0.5 rounded-full border border-blue-400 text-xs text-blue-200 uppercase tracking-wider bg-gradient-to-r from-blue-500 to-purple-600">INVITATION</div>
                <img src="images/osan_log3.svg" alt="ì˜¤ì‚°ê³  ë¡œê³ " class="w-12 h-12 object-contain">
            </div>

            <!-- ì œëª© -->
            <div class="text-center mb-6">
                <h1 class="text-3xl sm:text-5xl font-extrabold text-blue-200 mb-2">ì˜¤ì‚°ê³  71íšŒ</h1>
                <h2 class="text-4xl sm:text-6xl font-extrabold text-blue-300">ë™ê¸° ì†¡ë…„íšŒ</h2>
            </div>

            <!-- ë¶€ì œëª© -->
            <div class="text-center text-lg text-slate-200 mb-6 font-medium">
                ì˜¤ë˜ ë³´ë‹ˆ ë” ì¢‹ì€ ìš°ë¦¬,<br>2025ë…„ì˜ ëìë½ì„ í•¨ê»˜ ë§ˆë¬´ë¦¬í•´ìš”.
            </div>

            <!-- êµ¬ë¶„ì„  -->
            <div class="h-px bg-gradient-to-r from-transparent via-slate-500 to-transparent my-4"></div>
            <div class="h-1 bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400 rounded-full my-4"></div>

            <!-- í–‰ì‚¬ ì•ˆë‚´ -->
            <section class="mb-6">
                <h3 class="text-xl font-semibold text-blue-200 mb-3">ğŸ“… í–‰ì‚¬ ì•ˆë‚´</h3>
                <div class="text-slate-200 space-y-2">
                    <div><span class="text-slate-400">ì¼ì‹œ:</span> 2025ë…„ 11ì›” 29ì¼(í† ) 14:00 ~ 17:00</div>
                    <div><span class="text-slate-400">ì¥ì†Œ:</span> ì„œìš¸ëŒ€ì…êµ¬ì—­ <span class="font-bold text-yellow-300">ê¼¬ê¼¬ë‹­ê°ˆë¹„</span></div>
                    <div><span class="text-slate-400">ì¸ì›:</span> ì•½ 54ëª… ì˜ˆì •</div>
                </div>
            </section>

            <!-- í”„ë¡œê·¸ë¨ -->
            <section class="mb-6">
                <h3 class="text-xl font-semibold text-blue-200 mb-3">ğŸ‰ ì£¼ìš” ìˆœì„œ</h3>
                <div class="text-sm text-slate-300 space-y-1">
                    <div>â€¢ ì…ì¥ & ì¶œì„ì²´í¬ / ê°œíšŒ & ì‚¬íšŒì ì¸ì‚¬</div>
                    <div>â€¢ ì†Œëª¨ì„ ì†Œê°œ ë° í›„ì›ì ì†Œê°œ</div>
                    <div>â€¢ ë™ê¸° ëŒ€í‘œ ì¸ì‚¬ë§ & êµê°€ ì œì°½</div>
                    <div>â€¢ ê±´ë°°ì‚¬ í›„ ì‹ì‚¬ & ììœ  ëŒ€í™”</div>
                    <div>â€¢ ë‹¨ì²´ì‚¬ì§„ ì´¬ì˜ ë° ííšŒ ì•ˆë‚´</div>
                </div>
            </section>

            <!-- QR ì²´í¬ì¸ -->
            <div class="bg-gradient-to-br from-blue-800 via-slate-800 to-slate-900 rounded-2xl p-4 mb-6">
                <div class="flex items-center gap-4">
                    <div class="w-20 h-20 bg-white rounded-lg flex items-center justify-center p-1">
                        <canvas id="qrcode" class="w-full h-full"></canvas>
                        <img id="qrcode-fallback" style="display: none;" class="w-full h-full object-contain" alt="QRì½”ë“œ">
                    </div>
                    <div class="text-slate-200">
                        <div class="font-bold text-lg text-blue-200 mb-1">QR ì°ê³  ë¯¸ë¦¬ ì²´í¬ì¸í•´ ì£¼ì„¸ìš”</div>
                        <div class="text-sm leading-relaxed">
                            íœ´ëŒ€í° ì¹´ë©”ë¼ë¡œ QRì„ ë¹„ì¶”ë©´<br>
                            í–‰ì‚¬ ì•ˆë‚´ì™€ ì¶œì„ ì²´í¬ë¥¼<br>
                            í•œ ë²ˆì— í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
                        </div>
                        <div class="text-xs text-slate-400 mt-2 border-t border-slate-600 pt-2">
                            ğŸ’¡ QRì½”ë“œê°€ ì•ˆ ë  ê²½ìš° í´ë¦­í•˜ì„¸ìš”
                        </div>
                    </div>
                </div>
            </div>

            <!-- í‘¸í„° -->
            <div class="text-center">
                <div class="text-lg text-yellow-300 font-semibold mb-2">
                    âœ¨ "ì˜¤ë˜ ë³´ë‹ˆ ì¢‹ê³ , ì•ìœ¼ë¡œ ë” ì¢‹ì•„ì§ˆ ìš°ë¦¬"
                </div>
                <div class="text-sm text-slate-400">
                    11ì›” 29ì¼, ì„œìš¸ëŒ€ì…êµ¬ì—­ ê¼¬ê¼¬ë‹­ê°ˆë¹„ì—ì„œ ë°˜ê°€ìš´ ì–¼êµ´ë¡œ ëµ™ê² ìŠµë‹ˆë‹¤.
                </div>
            </div>

            <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
            <div class="mt-8 pt-6 border-t border-slate-600">
                <div class="flex gap-2">
                    <button onclick="window.location.href='invitation.html'" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm">
                        ğŸŠ ì´ˆëŒ€ì¥
                    </button>
                    <button onclick="window.location.href='checkin.html'" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg text-sm">
                        ğŸ“ ì²´í¬ì¸
                    </button>
                    <button onclick="window.location.href='admin.html'" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg text-sm">
                        âš™ï¸ ê´€ë¦¬
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ê°•ë ¥í•œ ìºì‹œ ë²„ì „ ì²´í¬ ë° ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥
        function checkCacheVersion() {
            const currentVersion = localStorage.getItem('cacheVersion');
            const pageVersion = sessionStorage.getItem('pageVersion');
            const forceReload = localStorage.getItem('forceReload');
            
            // ê°•ì œ ë¦¬ë¡œë“œ í”Œë˜ê·¸ê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ ë¦¬ë¡œë“œ
            if (forceReload === 'true') {
                localStorage.removeItem('forceReload');
                const url = new URL(window.location.href);
                url.searchParams.set('_cache', Date.now());
                window.location.replace(url.toString());
                return;
            }
            
            if (currentVersion && currentVersion !== pageVersion) {
                sessionStorage.setItem('pageVersion', currentVersion);
                console.log('ìºì‹œ ì—…ë°ì´íŠ¸ ê°ì§€ - í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨');
                location.reload(true); // ê°•ì œ ë¦¬ë¡œë“œ
            }
        }

        // QRì½”ë“œ ìƒì„±
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° ìºì‹œ ë²„ì „ ì„¤ì •
            if (!sessionStorage.getItem('pageVersion')) {
                sessionStorage.setItem('pageVersion', Date.now().toString());
            }
            
            // ì£¼ê¸°ì  ìºì‹œ ì²´í¬
            setInterval(checkCacheVersion, 3000);
            const canvas = document.getElementById('qrcode');
            const fallbackImg = document.getElementById('qrcode-fallback');
            
            if (!canvas || !fallbackImg) {
                console.error('QRì½”ë“œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ì²´í¬ì¸ URL ìƒì„± (ëª¨ë°”ì¼ ì ‘ê·¼ ê°€ëŠ¥)
            let checkinUrl;
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                // ë¡œì»¬ ì„œë²„ì¸ ê²½ìš° - ì‚¬ìš©ìê°€ ì§ì ‘ IPë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ì•ˆë‚´
                const currentUrl = window.location.href;
                checkinUrl = currentUrl.replace('invitation.html', 'checkin.html');
                
                // ì½˜ì†”ê³¼ í™”ë©´ì— ëª¨ë°”ì¼ ì ‘ê·¼ ë°©ë²• ì•ˆë‚´
                console.log('ğŸ“± ëª¨ë°”ì¼ì—ì„œ QRì½”ë“œ ìŠ¤ìº”ì´ ì•ˆ ë  ê²½ìš°:');
                console.log('1. ì»´í“¨í„° IP ì£¼ì†Œ í™•ì¸: ipconfig (Windows) ë˜ëŠ” ifconfig (Mac/Linux)');
                console.log('2. ëª¨ë°”ì¼ê³¼ ê°™ì€ WiFi ì—°ê²° í™•ì¸');
                console.log('3. ë°©í™”ë²½ì—ì„œ 8000ë²ˆ í¬íŠ¸ í—ˆìš©');
                console.log('í˜„ì¬ URL:', checkinUrl);
            } else {
                // ë°°í¬ëœ ì„œë²„ì¸ ê²½ìš° ì›ë˜ ë°©ì‹ ì‚¬ìš©
                checkinUrl = window.location.origin + window.location.pathname.replace('invitation.html', 'checkin.html');
            }
            console.log('QRì½”ë“œ URL:', checkinUrl);
            
            // ì™¸ë¶€ APIë¡œ QRì½”ë“œ ìƒì„±
            generateQRWithAPI(checkinUrl);

            function generateQRWithAPI(url) {
                const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=74x74&margin=1&data=${encodeURIComponent(url)}`;
                
                fallbackImg.src = qrApiUrl;
                fallbackImg.style.display = 'block';
                canvas.style.display = 'none';
                
                fallbackImg.onload = function() {
                    console.log('QRì½”ë“œ ìƒì„± ì„±ê³µ!');
                };
                
                fallbackImg.onerror = function() {
                    console.error('QRì½”ë“œ ìƒì„± ì‹¤íŒ¨, ë§í¬ ë²„íŠ¼ìœ¼ë¡œ ëŒ€ì²´');
                    canvas.parentElement.innerHTML = '<div class="text-xs text-gray-800 text-center p-2 cursor-pointer" onclick="window.location.href=\'checkin.html\'">ğŸ“±<br><span class="text-blue-600 font-semibold">ì²´í¬ì¸</span><br><span class="text-xs">íƒ­í•˜ê¸°</span></div>';
                };

                // í´ë¦­ ì‹œ ì²´í¬ì¸ í˜ì´ì§€ë¡œ ì´ë™
                fallbackImg.onclick = function() {
                    window.location.href = 'checkin.html';
                };
                fallbackImg.style.cursor = 'pointer';
                fallbackImg.title = 'í´ë¦­í•˜ì—¬ ì²´í¬ì¸ í˜ì´ì§€ë¡œ ì´ë™';
            }
        });
    </script>
</body>
</html>