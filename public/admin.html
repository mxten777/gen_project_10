<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="version" content="v2.1.0">
  <title>ìš´ì˜ì§„ ê´€ë¦¬ - ì˜¤ì‚°ê³  71íšŒ ë™ê¸° ì†¡ë…„íšŒ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans KR", sans-serif; }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-800 min-h-screen">
  <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-80 backdrop-blur-md border-b border-slate-600 shadow-lg">
    <div class="max-w-7xl mx-auto px-2 sm:px-4">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-2 sm:space-x-4">
          <img src="images/osan_log3.svg" alt="ì˜¤ì‚°ê³  ë¡œê³ " class="w-8 h-8 sm:w-12 sm:h-12 object-contain">
          <h1 class="text-white font-bold text-sm sm:text-lg drop-shadow-sm">ì˜¤ì‚°ê³  71íšŒ ì†¡ë…„íšŒ</h1>
        </div>
        <div class="flex space-x-1 sm:space-x-2">
          <a href="invitation.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold text-slate-200 hover:text-white hover:bg-slate-700 transition-colors">
            ğŸŠ <span class="hidden sm:inline">ì´ˆëŒ€ì¥</span>
          </a>
          <a href="checkin.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold text-slate-200 hover:text-white hover:bg-slate-700 transition-colors">
            ğŸ“ <span class="hidden sm:inline">ì²´í¬ì¸</span>
          </a>
          <a href="admin.html" class="px-2 py-1 sm:px-4 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-purple-600 text-white shadow-sm">
            âš™ï¸ <span class="hidden sm:inline">ê´€ë¦¬</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- ë©”ì¸ ì»¨í…ì¸  -->
  <div class="pt-16 px-2 sm:px-4 pb-4">
    <div class="max-w-6xl mx-auto">
      <!-- í—¤ë” -->
      <header class="mb-6 sm:mb-8 text-center">
        <h1 class="text-2xl sm:text-4xl font-bold text-white mb-2">ì˜¤ì‚°ê³  71íšŒ ë™ê¸° ì†¡ë…„íšŒ</h1>
        <h2 class="text-xl sm:text-2xl font-semibold text-blue-300 mb-4">ìš´ì˜ì§„ ëŒ€ì‹œë³´ë“œ</h2>
        <div class="bg-blue-800 bg-opacity-50 rounded-lg p-4 inline-block">
          <p class="text-white text-lg">
            ì´ <span id="totalCount" class="font-bold text-yellow-300">0ëª…</span> ì¤‘ 
            <span id="checkedInCount" class="font-bold text-green-300">0ëª…</span> ì²´í¬ì¸ ì™„ë£Œ
          </p>
        </div>
      </header>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
        <!-- ì°¸ì„ì ì¶”ê°€ ì„¹ì…˜ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-blue-500">
          <h3 class="text-xl font-semibold text-white mb-4">ì°¸ì„ì ì¶”ê°€</h3>
          <div class="space-y-4">
            <input
              type="text"
              id="newName"
              placeholder="ì´ë¦„"
              class="w-full p-3 rounded-lg bg-slate-800 text-white border border-slate-600 focus:border-blue-400 focus:outline-none"
            />
            <input
              type="text"
              id="newPhone"
              placeholder="ì „í™”ë²ˆí˜¸ (ì„ íƒì‚¬í•­)"
              class="w-full p-3 rounded-lg bg-slate-800 text-white border border-slate-600 focus:border-blue-400 focus:outline-none"
            />
            <button
              onclick="addAttendee()"
              class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
            >
              ì¶”ê°€
            </button>
          </div>
        </div>

        <!-- ì•¡ì…˜ ë²„íŠ¼ ì„¹ì…˜ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-green-500">
          <h3 class="text-xl font-semibold text-white mb-4">ëª…ë‹¨ ê´€ë¦¬</h3>
          <div class="space-y-3">
            <button
              onclick="copyToClipboard()"
              class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
            >
              ğŸ“‹ í´ë¦½ë³´ë“œ ë³µì‚¬
            </button>
            <button
              onclick="exportToCSV()"
              class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
            >
              ğŸ“ CSV ë‹¤ìš´ë¡œë“œ
            </button>
            <button
              onclick="clearAllData()"
              class="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
            >
              ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”
            </button>
            <button
              onclick="clearCache()"
              class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
            >
              ğŸ”„ ìºì‹œ ì´ˆê¸°í™”
            </button>
            <div class="text-sm text-slate-300 mt-4 p-3 bg-slate-800 rounded-lg">
              <p class="mb-1">ğŸ’¡ <strong>ì‚¬ìš©ë²•:</strong></p>
              <p class="text-xs">â€¢ ì²´í¬ì¸ ë²„íŠ¼ìœ¼ë¡œ ì¶œì„ ê´€ë¦¬</p>
              <p class="text-xs">â€¢ ì‚­ì œ ë²„íŠ¼ìœ¼ë¡œ ê°œë³„ ì œê±°</p>
              <p class="text-xs">â€¢ ë³µì‚¬/ë‹¤ìš´ë¡œë“œë¡œ ëª…ë‹¨ ë°±ì—…</p>
              <p class="text-xs text-red-300">â€¢ âš ï¸ ì „ì²´ ì´ˆê¸°í™”ëŠ” ì‹ ì¤‘íˆ ì‚¬ìš©</p>
              <p class="text-xs text-orange-300">â€¢ ğŸ”„ ìºì‹œ ì´ˆê¸°í™”ëŠ” ëª¨ë°”ì¼ ë°ì´í„° ë¬¸ì œ ì‹œ</p>
            </div>
          </div>
        </div>

        <!-- í†µê³„ ì„¹ì…˜ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-yellow-500">
          <h3 class="text-xl font-semibold text-white mb-4">ì‹¤ì‹œê°„ í˜„í™©</h3>
          <div class="space-y-3">
            <div class="bg-slate-800 rounded-lg p-3">
              <p class="text-yellow-300 font-semibold">ì²´í¬ì¸ í˜„í™©</p>
              <p id="progressText" class="text-2xl font-bold text-white">0 / 0</p>
              <div class="w-full bg-slate-700 rounded-full h-2 mt-2">
                <div id="progressBar" class="bg-gradient-to-r from-green-400 to-blue-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
              </div>
            </div>
            <div class="bg-slate-800 rounded-lg p-3">
              <p class="text-blue-300 font-semibold">ì™„ë£Œìœ¨</p>
              <p id="completionRate" class="text-2xl font-bold text-white">0%</p>
            </div>
          </div>
        </div>
      </div>

      <!-- ì°¸ì„ì ëª…ë‹¨ -->
      <div class="mt-8 bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-slate-500">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold text-white">ì°¸ì„ì ëª…ë‹¨</h3>
          <div class="flex items-center gap-4">
            <select id="sortOption" onchange="sortAttendees()" class="bg-slate-700 text-white text-sm px-3 py-1 rounded border border-slate-600 focus:border-blue-400">
              <option value="name">ì´ë¦„ìˆœ</option>
              <option value="checkin">ì²´í¬ì¸ìˆœ</option>
              <option value="time">ë“±ë¡ìˆœ</option>
            </select>
            <div class="text-sm text-slate-300">
              <span id="listCount">0ëª…</span> í‘œì‹œì¤‘
            </div>
          </div>
        </div>
        <div class="overflow-x-auto max-h-96 overflow-y-auto border border-slate-600 rounded-lg">
          <table class="w-full text-white text-sm">
            <thead class="bg-slate-800 sticky top-0">
              <tr class="border-b border-slate-600">
                <th class="text-left py-2 px-2 font-semibold">ì´ë¦„</th>
                <th class="text-left py-2 px-2 font-semibold hidden sm:table-cell">ì „í™”ë²ˆí˜¸</th>
                <th class="text-center py-2 px-2 font-semibold">ìƒíƒœ</th>
                <th class="text-center py-2 px-2 font-semibold hidden md:table-cell">ì²´í¬ì¸ ì‹œê°„</th>
                <th class="text-center py-2 px-2 font-semibold">ì•¡ì…˜</th>
              </tr>
            </thead>
            <tbody id="attendeesList">
              <tr id="emptyMessage">
                <td colspan="5" class="text-center py-8 text-slate-400">
                  ì•„ì§ ë“±ë¡ëœ ì°¸ì„ìê°€ ì—†ìŠµë‹ˆë‹¤.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    let attendees = [];

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    function loadAttendees() {
      const saved = localStorage.getItem('attendees');
      if (saved) {
        attendees = JSON.parse(saved);
      } else {
        // ìƒ˜í”Œ ë°ì´í„°
        attendees = [
          { id: '1', name: 'ê¹€ì² ìˆ˜', phone: '010-1234-5678', checkedIn: true, checkedInAt: '2025-11-29 13:45' },
          { id: '2', name: 'ì´ì˜í¬', phone: '010-2345-6789', checkedIn: false },
          { id: '3', name: 'ë°•ë¯¼ìˆ˜', checkedIn: true, checkedInAt: '2025-11-29 13:52' },
        ];
        saveAttendees();
      }
      sortAttendees(); // ì´ˆê¸° ë¡œë“œ ì‹œ ì´ë¦„ìˆœ ì •ë ¬
    }

    function saveAttendees() {
      localStorage.setItem('attendees', JSON.stringify(attendees));
      // ìºì‹œ ë²„ì „ ì—…ë°ì´íŠ¸ë¡œ ë‹¤ë¥¸ í˜ì´ì§€ì— ë³€ê²½ ì•Œë¦¼
      localStorage.setItem('cacheVersion', Date.now().toString());
    }

    function addAttendee() {
      const name = document.getElementById('newName').value.trim();
      const phone = document.getElementById('newPhone').value.trim();
      
      if (name) {
        const newAttendee = {
          id: Date.now().toString(),
          name: name,
          phone: phone || '',
          checkedIn: false
        };
        attendees.push(newAttendee);
        saveAttendees();
        sortAttendees(); // ìë™ ì •ë ¬ ì ìš©
        
        document.getElementById('newName').value = '';
        document.getElementById('newPhone').value = '';
      }
    }

    function removeAttendee(id) {
      attendees = attendees.filter(a => a.id !== id);
      saveAttendees();
      sortAttendees(); // ì‚­ì œ í›„ ì •ë ¬ ìœ ì§€
    }

    function toggleCheckIn(id) {
      attendees = attendees.map(a => 
        a.id === id 
          ? { 
              ...a, 
              checkedIn: !a.checkedIn, 
              checkedInAt: !a.checkedIn ? new Date().toLocaleString('ko-KR') : undefined 
            }
          : a
      );
      saveAttendees();
      sortAttendees(); // ì²´í¬ì¸ í›„ ì •ë ¬ ìœ ì§€
    }

    function sortAttendees() {
      const sortOption = document.getElementById('sortOption').value;
      
      switch(sortOption) {
        case 'name':
          attendees.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
          break;
        case 'checkin':
          attendees.sort((a, b) => {
            if (a.checkedIn === b.checkedIn) {
              return a.name.localeCompare(b.name, 'ko');
            }
            return b.checkedIn - a.checkedIn; // ì²´í¬ì¸ ì™„ë£Œê°€ ë¨¼ì €
          });
          break;
        case 'time':
          attendees.sort((a, b) => {
            const timeA = a.checkedInAt || a.registeredAt || '0';
            const timeB = b.checkedInAt || b.registeredAt || '0';
            return timeB.localeCompare(timeA); // ìµœì‹ ìˆœ
          });
          break;
      }
      
      renderAttendees();
      saveAttendees();
    }

    function renderAttendees() {
      const tbody = document.getElementById('attendeesList');
      const emptyMessage = document.getElementById('emptyMessage');
      
      if (attendees.length === 0) {
        emptyMessage.style.display = 'table-row';
      } else {
        emptyMessage.style.display = 'none';
        
        const rows = attendees.map(attendee => `
          <tr class="border-b border-slate-700 hover:bg-white hover:bg-opacity-5">
            <td class="py-2 px-2 font-semibold">
              <div>${attendee.name}</div>
              <div class="text-xs text-slate-400 sm:hidden">${attendee.phone || ''}</div>
            </td>
            <td class="py-2 px-2 text-slate-300 hidden sm:table-cell">${attendee.phone || '-'}</td>
            <td class="py-2 px-2 text-center">
              <span class="px-2 py-1 rounded-full text-xs font-semibold ${
                attendee.checkedIn 
                  ? 'bg-green-600 text-white' 
                  : 'bg-slate-600 text-slate-300'
              }">
                ${attendee.checkedIn ? 'âœ“' : 'â—‹'}
              </span>
              <div class="text-xs text-slate-400 mt-1 md:hidden">
                ${attendee.checkedInAt ? attendee.checkedInAt.split(' ')[1] : ''}
              </div>
            </td>
            <td class="py-2 px-2 text-center text-xs text-slate-300 hidden md:table-cell">
              ${attendee.checkedInAt || '-'}
            </td>
            <td class="py-2 px-2 text-center">
              <div class="flex flex-col sm:flex-row justify-center space-y-1 sm:space-y-0 sm:space-x-1">
                <button
                  onclick="toggleCheckIn('${attendee.id}')"
                  class="px-2 py-1 rounded text-xs font-semibold transition-colors ${
                    attendee.checkedIn
                      ? 'bg-yellow-600 hover:bg-yellow-700 text-white'
                      : 'bg-green-600 hover:bg-green-700 text-white'
                  }"
                >
                  ${attendee.checkedIn ? 'ì·¨ì†Œ' : 'ì²´í¬ì¸'}
                </button>
                <button
                  onclick="removeAttendee('${attendee.id}')"
                  class="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs font-semibold transition-colors"
                >
                  ì‚­ì œ
                </button>
              </div>
            </td>
          </tr>
        `).join('');
        
        tbody.innerHTML = emptyMessage.outerHTML + rows;
      }
      
      updateStats();
    }

    function updateStats() {
      const total = attendees.length;
      const checkedIn = attendees.filter(a => a.checkedIn).length;
      const rate = total > 0 ? Math.round((checkedIn / total) * 100) : 0;
      
      document.getElementById('totalCount').textContent = total + 'ëª…';
      document.getElementById('checkedInCount').textContent = checkedIn + 'ëª…';
      document.getElementById('progressText').textContent = `${checkedIn} / ${total}`;
      document.getElementById('completionRate').textContent = rate + '%';
      document.getElementById('progressBar').style.width = rate + '%';
      document.getElementById('listCount').textContent = total + 'ëª…';
    }

    function copyToClipboard() {
      const text = attendees.map(a => 
        `${a.name}\t${a.phone || ''}\t${a.checkedIn ? 'ì™„ë£Œ' : 'ë¯¸ì™„ë£Œ'}\t${a.checkedInAt || ''}`
      ).join('\n');
      
      navigator.clipboard.writeText(`ì´ë¦„\tì „í™”ë²ˆí˜¸\tì²´í¬ì¸ ì—¬ë¶€\tì²´í¬ì¸ ì‹œê°„\n${text}`)
        .then(() => alert('ëª…ë‹¨ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'))
        .catch(() => alert('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'));
    }

    function exportToCSV() {
      const headers = ['ì´ë¦„', 'ì „í™”ë²ˆí˜¸', 'ì²´í¬ì¸ ì—¬ë¶€', 'ì²´í¬ì¸ ì‹œê°„'];
      const rows = attendees.map(a => [
        a.name,
        a.phone || '',
        a.checkedIn ? 'ì™„ë£Œ' : 'ë¯¸ì™„ë£Œ',
        a.checkedInAt || ''
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
      
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      link.setAttribute('href', url);
      link.setAttribute('download', `ì†¡ë…„íšŒ_ì°¸ì„ìëª…ë‹¨_${new Date().toISOString().split('T')[0]}.csv`);
      link.click();
    }

    function clearAllData() {
      if (attendees.length === 0) {
        alert('ì´ˆê¸°í™”í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }

      const confirmMessage = `ì •ë§ë¡œ ëª¨ë“  ì°¸ì„ì ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní˜„ì¬ ë“±ë¡ëœ ì¸ì›: ${attendees.length}ëª…\nì²´í¬ì¸ ì™„ë£Œ: ${attendees.filter(a => a.checkedIn).length}ëª…\n\nâš ï¸ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!`;
      
      if (confirm(confirmMessage)) {
        // ì¶”ê°€ í™•ì¸
        const finalConfirm = confirm('ë§ˆì§€ë§‰ í™•ì¸ì…ë‹ˆë‹¤.\nì •ë§ë¡œ ì „ì²´ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
        if (finalConfirm) {
          attendees = [];
          localStorage.removeItem('attendees');
          renderAttendees();
          updateStats();
          alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
      }
    }

    function clearCache() {
      if (confirm('ëª¨ë“  ìºì‹œë¥¼ ì™„ì „íˆ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.\n- ë¸Œë¼ìš°ì € ìºì‹œ\n- localStorage ë°ì´í„°\n- ì„¸ì…˜ ë°ì´í„°\n\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        try {
          // 1. ëª¨ë“  localStorage ë°ì´í„° ë°±ì—…
          const attendeesBackup = localStorage.getItem('attendees');
          
          // 2. ì „ì²´ localStorage í´ë¦¬ì–´
          localStorage.clear();
          
          // 3. attendees ë°ì´í„°ë§Œ ë³µì› (ìµœì‹  ë²„ì „ìœ¼ë¡œ)
          if (attendeesBackup) {
            localStorage.setItem('attendees', attendeesBackup);
          }
          
          // 4. ìƒˆë¡œìš´ ìºì‹œ ë²„ì „ ì„¤ì •
          const newVersion = Date.now().toString();
          localStorage.setItem('cacheVersion', newVersion);
          localStorage.setItem('forceReload', 'true');
          
          // 5. ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ í´ë¦¬ì–´
          sessionStorage.clear();
          sessionStorage.setItem('pageVersion', newVersion);
          
          // 6. ì„œë¹„ìŠ¤ ì›Œì»¤ ì™„ì „ ì œê±°
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
              registrations.forEach(function(registration) {
                registration.unregister();
              });
            });
          }
          
          // 7. ë¸Œë¼ìš°ì € ìºì‹œ ì™„ì „ ì‚­ì œ
          if ('caches' in window) {
            caches.keys().then(function(names) {
              names.forEach(function(name) {
                caches.delete(name);
              });
            });
          }
          
          // 8. ì¿ í‚¤ ì‚­ì œ ì‹œë„
          document.cookie.split(";").forEach(function(c) { 
            document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
          });
          
          alert('âœ… ìºì‹œê°€ ì™„ì „íˆ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ“± ëª¨ë°”ì¼ì—ì„œë„:\n1. ë¸Œë¼ìš°ì € ì„¤ì • > ìºì‹œ ì‚­ì œ\n2. ë˜ëŠ” ì‹œí¬ë¦¿/ì‚¬ìƒí™œ ë³´í˜¸ ëª¨ë“œë¡œ ì ‘ì†í•˜ì„¸ìš”.');
          
          // 9. URLì— íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€í•˜ì—¬ ê°•ì œ ë¦¬ë¡œë“œ
          const url = new URL(window.location.href);
          url.searchParams.set('_t', Date.now());
          window.location.href = url.toString();
          
        } catch (error) {
          console.error('ìºì‹œ í´ë¦¬ì–´ ì¤‘ ì˜¤ë¥˜:', error);
          alert('âŒ ìºì‹œ í´ë¦¬ì–´ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nìˆ˜ë™ìœ¼ë¡œ ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ìºì‹œë¥¼ ì‚­ì œí•´ì£¼ì„¸ìš”.');
        }
      }
    }

    // Enter í‚¤ë¡œ ì¶”ê°€ ê¸°ëŠ¥
    document.getElementById('newName').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') addAttendee();
    });
    
    document.getElementById('newPhone').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') addAttendee();
    });

    // ê°•ë ¥í•œ ìºì‹œ ë²„ì „ ì²´í¬ ë° ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥
    function checkCacheVersion() {
      const currentVersion = localStorage.getItem('cacheVersion');
      const pageVersion = sessionStorage.getItem('pageVersion');
      const forceReload = localStorage.getItem('forceReload');
      
      // ê°•ì œ ë¦¬ë¡œë“œ í”Œë˜ê·¸ê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ ë¦¬ë¡œë“œ
      if (forceReload === 'true') {
        localStorage.removeItem('forceReload');
        const url = new URL(window.location.href);
        url.searchParams.set('_cache', Date.now());
        window.location.replace(url.toString());
        return;
      }
      
      if (currentVersion && currentVersion !== pageVersion) {
        sessionStorage.setItem('pageVersion', currentVersion);
        console.log('ìºì‹œ ì—…ë°ì´íŠ¸ ê°ì§€ - ë°ì´í„° ìƒˆë¡œê³ ì¹¨');
        // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        updateDataAndUI();
      }
    }

    // ë°ì´í„° ì—…ë°ì´íŠ¸ ë° ìƒˆë¡œê³ ì¹¨
    function updateDataAndUI() {
      loadAttendees();
      renderAttendees();
      updateStats();
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
    window.addEventListener('load', function() {
      // ì´ˆê¸° ìºì‹œ ë²„ì „ ì„¤ì •
      if (!sessionStorage.getItem('pageVersion')) {
        sessionStorage.setItem('pageVersion', Date.now().toString());
      }
      
      updateDataAndUI();
      
      // ì£¼ê¸°ì ìœ¼ë¡œ ìºì‹œ ë²„ì „ ì²´í¬ (ê´€ë¦¬ì í˜ì´ì§€ëŠ” ë” ìì£¼)
      setInterval(checkCacheVersion, 2000);
      checkCacheVersion();
      
      // ì£¼ê¸°ì ìœ¼ë¡œ ìºì‹œ ì²´í¬
      setInterval(checkCacheVersion, 5000);
    });
  </script>
</body>
</html>