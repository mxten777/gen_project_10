<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œìŠ¤í…œ ë””ë²„ê·¸ - ì˜¤ì‚°ê³  71íšŒ ì†¡ë…„íšŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/firebase-config.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- í—¤ë” -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-white mb-4">
                ğŸ”§ ì‹œìŠ¤í…œ ë””ë²„ê·¸
            </h1>
            <p class="text-blue-200">Firebase ì—°ê²° ìƒíƒœ ë° ë°ì´í„° í™•ì¸</p>
        </header>

        <!-- Firebase ìƒíƒœ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-blue-500 mb-6">
            <h2 class="text-xl font-semibold text-white mb-4">ğŸ”¥ Firebase ìƒíƒœ</h2>
            <div id="firebaseStatus" class="text-gray-300">
                <p>ğŸ”„ ì—°ê²° í™•ì¸ ì¤‘...</p>
            </div>
        </div>

        <!-- ë°ì´í„° ìƒíƒœ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-green-500 mb-6">
            <h2 class="text-xl font-semibold text-white mb-4">ğŸ“Š ë°ì´í„° ìƒíƒœ</h2>
            <div id="dataStatus" class="text-gray-300">
                <p>ğŸ“¥ ë°ì´í„° ë¡œë”© ì¤‘...</p>
            </div>
        </div>

        <!-- ì°¸ì„ì ëª©ë¡ (ê°„ë‹¨ í‘œì‹œ) -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-purple-500 mb-6">
            <h2 class="text-xl font-semibold text-white mb-4">ğŸ‘¥ ì°¸ì„ì ëª©ë¡</h2>
            <div id="attendeeData" class="text-gray-300">
                <p>ğŸ‘¤ ì°¸ì„ì ë°ì´í„° ë¡œë”© ì¤‘...</p>
            </div>
        </div>

        <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
        <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-xl p-6 border border-yellow-500">
            <h2 class="text-xl font-semibold text-white mb-4">ğŸ› ï¸ ë””ë²„ê·¸ ë„êµ¬</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <button onclick="refreshData()" class="bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                    ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                </button>
                <button onclick="testFirebase()" class="bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                    ğŸ§ª Firebase í…ŒìŠ¤íŠ¸
                </button>
                <button onclick="showLogs()" class="bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                    ğŸ“‹ ë¡œê·¸ ë³´ê¸°
                </button>
                <a href="/" class="bg-gray-600 hover:bg-gray-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors text-center">
                    ğŸ  ë©”ì¸ìœ¼ë¡œ
                </a>
            </div>
        </div>
    </div>

    <script>
        let attendees = [];
        
        // Firebase ì—°ê²° ìƒíƒœ í™•ì¸
        function checkFirebaseStatus() {
            const statusElement = document.getElementById('firebaseStatus');
            
            if (window.firebaseManager) {
                statusElement.innerHTML = `
                    <div class="space-y-2">
                        <p class="text-green-400">âœ… Firebase Manager ë¡œë“œë¨</p>
                        <p class="text-blue-400">ğŸ”— ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™œì„±</p>
                        <p class="text-yellow-400">â° ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ëŒ€ê¸° ì¤‘</p>
                    </div>
                `;
                loadData();
            } else {
                statusElement.innerHTML = `
                    <div class="space-y-2">
                        <p class="text-red-400">âŒ Firebase Manager ë¡œë“œ ì‹¤íŒ¨</p>
                        <p class="text-gray-400">ğŸ”§ ì„¤ì • íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”</p>
                    </div>
                `;
            }
        }

        // ë°ì´í„° ë¡œë“œ
        async function loadData() {
            try {
                const data = await window.firebaseManager.getAttendees();
                attendees = data;
                updateDataStatus();
                displayAttendees();
            } catch (error) {
                document.getElementById('dataStatus').innerHTML = `
                    <p class="text-red-400">âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</p>
                `;
            }
        }

        // ë°ì´í„° ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateDataStatus() {
            const checkedIn = attendees.filter(a => a.checkedIn).length;
            document.getElementById('dataStatus').innerHTML = `
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div>ğŸ“Š ì „ì²´ ì°¸ì„ì: <span class="text-blue-300 font-bold">${attendees.length}ëª…</span></div>
                    <div>âœ… ì²´í¬ì¸ ì™„ë£Œ: <span class="text-green-300 font-bold">${checkedIn}ëª…</span></div>
                    <div>â³ ëŒ€ê¸° ì¤‘: <span class="text-yellow-300 font-bold">${attendees.length - checkedIn}ëª…</span></div>
                    <div>ğŸ“ˆ ì²´í¬ì¸ìœ¨: <span class="text-purple-300 font-bold">${attendees.length > 0 ? Math.round((checkedIn/attendees.length)*100) : 0}%</span></div>
                </div>
            `;
        }

        // ì°¸ì„ì ëª©ë¡ í‘œì‹œ
        function displayAttendees() {
            const element = document.getElementById('attendeeData');
            
            if (attendees.length === 0) {
                element.innerHTML = '<p class="text-gray-400">ğŸ“ ë“±ë¡ëœ ì°¸ì„ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            const list = attendees.slice(0, 10).map(a => `
                <div class="flex justify-between items-center py-2 border-b border-gray-600">
                    <div>
                        <span class="text-white font-medium">${a.name}</span>
                        ${a.phone ? `<span class="text-gray-400 text-sm ml-2">(${a.phone})</span>` : ''}
                    </div>
                    <div>
                        ${a.checkedIn ? 
                            '<span class="bg-green-600 text-white px-2 py-1 rounded text-xs">âœ“ ì²´í¬ì¸</span>' : 
                            '<span class="bg-gray-600 text-white px-2 py-1 rounded text-xs">ëŒ€ê¸°</span>'
                        }
                    </div>
                </div>
            `).join('');

            element.innerHTML = `
                <div class="space-y-1">
                    ${list}
                    ${attendees.length > 10 ? `<p class="text-gray-400 text-sm mt-4">... ì™¸ ${attendees.length - 10}ëª… ë”</p>` : ''}
                </div>
            `;
        }

        // ìƒˆë¡œê³ ì¹¨
        function refreshData() {
            document.getElementById('dataStatus').innerHTML = '<p class="text-blue-400">ğŸ”„ ìƒˆë¡œê³ ì¹¨ ì¤‘...</p>';
            document.getElementById('attendeeData').innerHTML = '<p class="text-blue-400">ğŸ‘¥ ì°¸ì„ì ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì¤‘...</p>';
            
            setTimeout(() => {
                checkFirebaseStatus();
            }, 500);
        }

        // Firebase í…ŒìŠ¤íŠ¸
        async function testFirebase() {
            if (!window.firebaseManager) {
                alert('âŒ Firebase Managerê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            try {
                const testData = {
                    id: 'test-' + Date.now(),
                    name: 'í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì',
                    phone: '010-1234-5678',
                    checkedIn: false,
                    timestamp: new Date().toISOString()
                };

                await window.firebaseManager.addAttendee(testData);
                alert('âœ… Firebase í…ŒìŠ¤íŠ¸ ì„±ê³µ! í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                refreshData();
            } catch (error) {
                alert('âŒ Firebase í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ë¡œê·¸ ë³´ê¸°
        function showLogs() {
            console.log('=== ë””ë²„ê·¸ ì •ë³´ ===');
            console.log('Firebase Manager:', window.firebaseManager);
            console.log('ì°¸ì„ì ë°ì´í„°:', attendees);
            console.log('í˜„ì¬ ì‹œê°„:', new Date().toISOString());
            alert('ğŸ” ë¸Œë¼ìš°ì € ê°œë°œìë„êµ¬ ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.\n\nF12 â†’ Console íƒ­ì—ì„œ ìƒì„¸ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('load', function() {
            console.log('ğŸ”§ ë””ë²„ê·¸ í˜ì´ì§€ ë¡œë“œë¨');
            
            // Firebase ë¡œë“œ ëŒ€ê¸°
            setTimeout(checkFirebaseStatus, 1000);
            
            // ì£¼ê¸°ì  ìƒíƒœ ì²´í¬
            setInterval(checkFirebaseStatus, 10000);
        });
    </script>
</body>
</html>